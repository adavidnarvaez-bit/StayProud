<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Disponibilidad – StayProud</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    :root {
      --primary: #00bfa6;
      --bg-page: #f5f5f5;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-page);
      padding: 20px;
    }

    .calendar-card {
      max-width: 720px;
      margin: 0 auto;
      background: #fff;
      border-radius: 16px;
      padding: 22px 24px 24px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
    }

    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .calendar-header h2 {
      margin: 0;
      font-size: 20px;
      color: #222;
    }

    .calendar-nav button {
      border: none;
      background: var(--primary);
      color: #fff;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
    }

    .calendar-nav button:hover {
      opacity: 0.9;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 6px;
      margin-top: 8px;
    }

    .calendar-weekday {
      text-align: center;
      font-size: 12px;
      font-weight: 600;
      color: #777;
      padding-bottom: 4px;
    }

    .calendar-day {
      height: 42px;
      border-radius: 10px;
      border: 1px solid #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      cursor: pointer;
      transition: box-shadow 0.15s, transform 0.1s;
    }

    .calendar-day.disabled {
      background: #f0f0f0;
      color: #b0b0b0;
      cursor: default;
    }

    .calendar-day:hover:not(.disabled) {
      box-shadow: 0 0 0 2px rgba(0,191,166,0.30);
    }

    /* Estados */
    .calendar-day.free {
      background: #ffffff;
      color: #333;
    }

    .calendar-day.inquiry {
      background: #ffe66b;
      border-color: #ffd54f;
      color: #333;
    }

    .calendar-day.reserved {
      background: var(--primary);
      border-color: var(--primary);
      color: #fff;
      font-weight: 600;
    }

    /* Leyenda */
    .calendar-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 16px;
      font-size: 13px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .legend-color {
      width: 16px;
      height: 16px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    .legend-free { background: #ffffff; }
    .legend-inquiry { background: #ffe66b; border-color: #ffd54f; }
    .legend-reserved { background: var(--primary); border-color: var(--primary); }

    /* Botón volver */
    .volver {
      display: block;
      max-width: 720px;
      margin: 12px auto 0;
      text-align: right;
    }
    .volver a {
      display: inline-block;
      padding: 8px 18px;
      border-radius: 999px;
      border: 1px solid var(--primary);
      color: var(--primary);
      text-decoration: none;
      font-size: 13px;
      font-weight: 600;
    }
    .volver a:hover {
      background: #e0f7f5;
    }

    @media (max-width: 480px) {
      body { padding: 12px; }
      .calendar-card { padding: 18px; }
      .calendar-day { height: 36px; font-size: 12px; }
    }
  </style>
</head>
<body>

<div class="calendar-card">
  <div class="calendar-header">
    <h2 id="calendar-title">Disponibilidad</h2>
    <div class="calendar-nav">
      <button id="prev-month" aria-label="Mes anterior">&lt;</button>
      <button id="next-month" aria-label="Mes siguiente">&gt;</button>
    </div>
  </div>

  <div class="calendar-grid" id="calendar-grid">
    <!-- Se rellena con JS -->
  </div>

  <div class="calendar-legend">
    <div class="legend-item">
      <span class="legend-color legend-free"></span>
      <span>Libre</span>
    </div>
    <div class="legend-item">
      <span class="legend-color legend-inquiry"></span>
      <span>Consulta / interesado</span>
    </div>
    <div class="legend-item">
      <span class="legend-color legend-reserved"></span>
      <span>Reservado</span>
    </div>
  </div>
</div>

<div class="volver">
  <a href="alojamientos.html">← Volver a alojamientos</a>
</div>

<script>
  // Estado interno de los días
  const dateStates = {}; // { "YYYY-MM-DD": "free" | "inquiry" | "reserved" }

  // Si quieres precargar reservas/consultas, ponlas aquí:
  const initialReserved = [
    // "2025-12-24",
    // "2025-12-25"
  ];
  const initialInquiry = [
    // "2025-12-20"
  ];

  initialReserved.forEach(d => dateStates[d] = "reserved");
  initialInquiry.forEach(d => dateStates[d] = "inquiry");

  const monthNames = [
    "enero","febrero","marzo","abril","mayo","junio",
    "julio","agosto","septiembre","octubre","noviembre","diciembre"
  ];
  const weekDays = ["L","M","X","J","V","S","D"];

  let currentDate = new Date();
  currentDate.setDate(1);

  const titleEl = document.getElementById("calendar-title");
  const gridEl = document.getElementById("calendar-grid");

  function renderCalendar() {
    gridEl.innerHTML = "";

    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();

    titleEl.textContent = Disponibilidad – ${monthNames[month]} ${year};

    // Encabezado de días
    weekDays.forEach(d => {
      const el = document.createElement("div");
      el.className = "calendar-weekday";
      el.textContent = d;
      gridEl.appendChild(el);
    });

    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const daysInMonth = lastDay.getDate();

    // Ajustar inicio (lunes = 1, domingo = 7)
    let startIndex = firstDay.getDay(); // 0 = domingo
    if (startIndex === 0) startIndex = 7;

    // Huecos antes del 1
    for (let i = 1; i < startIndex; i++) {
      const empty = document.createElement("div");
      empty.className = "calendar-day disabled";
      gridEl.appendChild(empty);
    }

    // Días del mes
    for (let day = 1; day <= daysInMonth; day++) {
      const cellDate = new Date(year, month, day);
      const iso = cellDate.toISOString().split("T")[0];

      const cell = document.createElement("div");
      const state = dateStates[iso] || "free";

      cell.className = "calendar-day " + state;
      cell.textContent = day;

      cell.addEventListener("click", () => {
        toggleState(iso);
        renderCalendar();
      });

      gridEl.appendChild(cell);
    }
  }

  function toggleState(isoDate) {
    const current = dateStates[isoDate] || "free";
    let next;
    if (current === "free")      next = "inquiry";
    else if (current === "inquiry") next = "reserved";
    else                         next = "free";

    dateStates[isoDate] = next;
    console.log("Estado actualizado:", isoDate, next);
  }

  document.getElementById("prev-month").addEventListener("click", () => {
    currentDate.setMonth(currentDate.getMonth() - 1);
    renderCalendar();
  });

  document.getElementById("next-month").addEventListener("click", () => {
    currentDate.setMonth(currentDate.getMonth() + 1);
    renderCalendar();
  });

  renderCalendar();
</script>

</body>
</html>